---
title: 'UI Core Behaviors and Theming'
summary: 'Guide to using @web-loom/ui-core behaviors with store-core plus how to wire themes via @web-loom/design-core utils.'
topicTitle: 'Published Packages'
topicSlug: 'packages'
---

# UI Core Behaviors and Theming

`@web-loom/ui-core` delivers framework-agnostic, headless UI behaviors that are built on `@web-loom/store-core` so you can share consistent interactions across React, Vue, Angular, or vanilla apps. Every behavior exposes state, actions, and subscriptions for dialog stacks, disclosures, roving focus, keyboard shortcuts, command palettes, undo/redo stacks, and other composable building blocks.

## Installation & setup

```bash
npm install @web-loom/ui-core @web-loom/store-core
```

Each behavior is shipped as a `createXxxBehavior` helper that returns:

- `getState()`/`subscribe()` for reading reactive state
- `actions` for mutating the behavior
- `destroy()` for cleanup

```ts
import { createDialogBehavior } from '@web-loom/ui-core';

const dialog = createDialogBehavior({
  id: 'settings',
  onOpen: () => console.log('dialog opened'),
});

dialog.actions.open({ title: 'Settings' });
const unsubscribe = dialog.subscribe((state) => console.log(state.isOpen));
```

Behaviors rely on `@web-loom/store-core` internally, so you can reuse the same stores or wire up custom `createStore` instances when you need to blend UI state with other app-level stores.

## Key behaviors at a glance

- **Dialog / Modal**: Manage stacked dialogs with focus trapping and `escape`/backdrop dismissal.
- **Disclosure / Accordion**: Control expand/collapse state for panels or dropdowns.
- **List Selection & Roving Focus**: Keyboard-aware selection and focus handling for toolbars, grids, or menus.
- **Keyboard Shortcuts**: Normalize platform keys, register descriptors, and guard against duplicates.
- **Command Palette**: Expose search helpers tied to behaviors and event buses.
- **Undo/Redo Stack**: Maintain a history of immutable states with `push`, `undo`, and `redo` commands.

These behaviors are used extensively in `@web-loom/ui-patterns` demos (hub-and-spoke, modal stacks, toast queues, grid layouts) and in `apps/task-flow-ui`/`apps/mvvm-react-integrated` to compose consistent UI without coupling to a framework.

## Theme integration

UI Core tokens assume a theming system on top of `@web-loom/design-core`. That package provides `createTheme`, `applyTheme`, and `setTheme` to compile token overrides into CSS variables scoped by `[data-theme="name"]` selectors.

```ts
import { createTheme, applyTheme, setTheme } from '@web-loom/design-core/utils';

const darkTheme = createTheme('dark', {
  colors: {
    background: { page: '#050609', surface: '#0d0f14' },
    text: { primary: '#f3f4f6' },
    brand: { primary: '#f6f7fb' },
  },
});

const lightTheme = createTheme('light', {
  colors: {
    background: { page: '#f6f8fb', surface: '#ffffff' },
    text: { primary: '#111827' },
    brand: { primary: '#2563eb' },
  },
});

await applyTheme(darkTheme);
await applyTheme(lightTheme);
setTheme('light'); // toggles the data-theme attribute
```

Call `applyTheme` once on each theme before switching to it so the CSS is injected early. When you call `setTheme('dark')`, the helper toggles `document.documentElement.dataset.theme` and the CSS variables automatically flow into UI Core behaviors (and any CSS that reads the tokens). Store user preferences in local storage (see `apps/task-flow-ui/src/providers/ThemeProvider.tsx` or `apps/mvvm-react-integrated/src/providers/ThemeProvider.tsx`) and keep a `ThemeContext` or provider so components can toggle modes and respect `prefers-color-scheme`.

If you render UI Core behaviors server-side (e.g., Next.js), hydrate themes on mount and avoid flicker by applying the default tokens inline before React renders. The docs app itself wraps everything in `apps/docs/app/theme-provider.tsx` using `next-themes` so the UI can supply a `class` attribute per theme.

## Practical tips

1. **Compose behaviors** by importing them from `@web-loom/ui-core` and passing shared store references when necessary (e.g., linking a `createDialogBehavior` stack with a `createKeyboardShortcuts`).
2. **Use design tokens**: UI Core styles read CSS custom properties generated by `applyTheme`, so make sure your token set includes backgrounds, borders, text, and elevation for both light and dark variants.
3. **Respect cleanup**: Call `destroy()` on behaviors and unsubscribe from stores when components unmount to avoid leaking listeners.
4. **Theme toggles** should update both CSS (via `setTheme`) and persisted preferences (via `localStorage` or `store-core`). The Task Flow UI `ThemeProvider` is a concrete example of applying multiple themes and syncing UI state with preferences.

## Learn more

- `packages/ui-core/docs` folder contains behavior-specific guides (modal, wizard, hub-and-spoke, toast queues, etc.).
- `@web-loom/design-core` README explains advanced theming utilities like `generateCssVariablesString` or scoping overrides to custom selectors.
- Look at `apps/task-flow-ui` and `apps/mvvm-react-integrated` for production-ready theme providers and behavior compositions with UI Core.
